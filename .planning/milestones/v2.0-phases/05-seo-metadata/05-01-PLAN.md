---
phase: 05-seo-metadata
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/layouts/Base.astro
  - src/styles/global.css
  - src/i18n/ui.ts
  - public/og-image.png
autonomous: true
requirements:
  - I18N-03
  - I18N-05
  - SEO-01
  - SEO-02
  - SEO-03

must_haves:
  truths:
    - "Viewing page source on both / and /en/ shows three hreflang link tags (it, en, x-default) with absolute URLs"
    - "Schema.org Validator confirms valid Person JSON-LD on both locale pages"
    - "Sharing the page URL shows a rich preview with 1200x630 image, correct title and description in page language"
    - "Clicking /#imprenditoria scrolls smoothly to the entrepreneurship section with hash visible in URL"
    - "og:locale meta tag shows it_IT on Italian page and en_US on English page"
  artifacts:
    - path: "src/layouts/Base.astro"
      provides: "hreflang tags, JSON-LD, og:image tags, og:locale, Twitter card tags, smooth scroll integration"
      contains: "hreflang"
    - path: "src/styles/global.css"
      provides: "scroll-behavior: smooth with prefers-reduced-motion override"
      contains: "scroll-behavior"
    - path: "src/i18n/ui.ts"
      provides: "og:locale values for each language"
      contains: "og.locale"
    - path: "public/og-image.png"
      provides: "1200x630 static PNG for social sharing previews"
  key_links:
    - from: "src/layouts/Base.astro"
      to: "astro:i18n"
      via: "getAbsoluteLocaleUrl import for hreflang URLs"
      pattern: "getAbsoluteLocaleUrl"
    - from: "src/layouts/Base.astro"
      to: "public/og-image.png"
      via: "new URL('/og-image.png', Astro.site) for og:image absolute URL"
      pattern: "og-image\\.png.*Astro\\.site"
    - from: "src/layouts/Base.astro"
      to: "JSON-LD script tag"
      via: "JSON.stringify of Person schema object injected with set:html"
      pattern: "application/ld\\+json"
---

<objective>
Add complete SEO metadata and structured data to both locale pages: hreflang cross-references, Schema.org Person JSON-LD, og:image with social sharing meta tags, translated og:locale, Twitter Card tags, and smooth-scrolling anchor links.

Purpose: Enable rich social media previews, proper search engine language indexing, structured data validation, and smooth in-page navigation for all section anchors.
Output: Base.astro with full SEO head section, og-image.png in public/, smooth scroll CSS in global.css.
</objective>

<execution_context>
@/home/toto/.claude/get-shit-done/workflows/execute-plan.md
@/home/toto/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-seo-metadata/05-RESEARCH.md
@.planning/phases/04-dark-mode/04-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create og:image PNG and add smooth scroll CSS</name>
  <files>public/og-image.png, src/styles/global.css</files>
  <action>
1. Create a minimalist 1200x630 PNG for social sharing previews at `public/og-image.png`:
   - Use a Node.js script with the `canvas` package (npx it if not installed: `npx -y canvas` or use sharp/jimp) OR use ImageMagick `convert` command (check if available with `which convert` or `which magick`)
   - Design: white background (#ffffff), "Antonio Castaldi" as large centered text, subtitle "Imprenditore | Informatico | Personal Trainer" below, site URL "toto-castaldi.github.io" at the bottom in smaller text
   - Minimalist style matching the site aesthetic: dark text on white background, system font feel
   - If canvas/ImageMagick not available, create a simple SVG and convert it, or use Python PIL if available
   - The image must be exactly 1200x630 pixels and in PNG format
   - Shared by both locales (name is the same in both languages)

2. Add smooth scroll CSS to `src/styles/global.css`:
   - Add `scroll-behavior: smooth;` to the existing `html` rule (merge with existing html selector that already has font-family, font-size, etc.)
   - Add `@media (prefers-reduced-motion: reduce) { html { scroll-behavior: auto; } }` after the html rule to respect accessibility preferences
  </action>
  <verify>
- `file public/og-image.png` confirms it's a PNG image
- `identify public/og-image.png` (if ImageMagick available) confirms 1200x630 dimensions, OR check with a script
- `grep 'scroll-behavior' src/styles/global.css` shows both smooth and auto rules
- `grep 'prefers-reduced-motion' src/styles/global.css` confirms accessibility override exists
  </verify>
  <done>A 1200x630 PNG exists at public/og-image.png with site branding, and global.css includes scroll-behavior: smooth with prefers-reduced-motion fallback</done>
</task>

<task type="auto">
  <name>Task 2: Add hreflang, JSON-LD, og:image, og:locale, and Twitter Card tags to Base.astro</name>
  <files>src/layouts/Base.astro, src/i18n/ui.ts</files>
  <action>
1. Update `src/i18n/ui.ts` to add og:locale values for each language:
   - Add `'og.locale': 'it_IT'` to the `it` translation object
   - Add `'og.locale': 'en_US'` to the `en` translation object

2. Update `src/layouts/Base.astro` frontmatter:
   - Add import: `import { getAbsoluteLocaleUrl } from 'astro:i18n';`
   - Add import: `import { useTranslations } from '../i18n/utils';`
   - Create locale URL variables:
     ```
     const t = useTranslations(lang);
     const itUrl = getAbsoluteLocaleUrl('it', '');
     const enUrl = getAbsoluteLocaleUrl('en', '');
     const ogImageURL = new URL('/og-image.png', Astro.site);
     ```
   - Build Person JSON-LD object using `JSON.stringify()` (NOT template literals):
     ```
     const personJsonLd = JSON.stringify({
       "@context": "https://schema.org",
       "@type": "Person",
       "name": "Antonio Castaldi",
       "alternateName": "Toto",
       "url": "https://toto-castaldi.github.io",
       "image": ogImageURL.toString(),
       "jobTitle": lang === 'it'
         ? ["Imprenditore", "Informatico", "Personal Trainer"]
         : ["Entrepreneur", "Software Engineer", "Personal Trainer"],
       "worksFor": {
         "@type": "Organization",
         "name": "Skillbill srl",
         "url": "https://www.skillbill.it/"
       },
       "knowsLanguage": ["it", "en"],
       "sameAs": [
         "https://github.com/toto-castaldi",
         "https://toto-castaldi.com"
       ]
     });
     ```

3. Add to `<head>` section of Base.astro (after existing OG tags):
   - hreflang tags (I18N-03):
     ```
     <link rel="alternate" hreflang="it" href={itUrl} />
     <link rel="alternate" hreflang="en" href={enUrl} />
     <link rel="alternate" hreflang="x-default" href={itUrl} />
     ```
   - og:image tags (SEO-02):
     ```
     <meta property="og:image" content={ogImageURL} />
     <meta property="og:image:width" content="1200" />
     <meta property="og:image:height" content="630" />
     <meta property="og:image:type" content="image/png" />
     ```
   - og:locale tags (I18N-05):
     ```
     <meta property="og:locale" content={t('og.locale')} />
     <meta property="og:locale:alternate" content={lang === 'it' ? 'en_US' : 'it_IT'} />
     ```
   - Twitter Card tags:
     ```
     <meta name="twitter:card" content="summary_large_image" />
     <meta name="twitter:title" content={title} />
     <meta name="twitter:description" content={description} />
     <meta name="twitter:image" content={ogImageURL} />
     ```
   - Person JSON-LD (SEO-01):
     ```
     <script type="application/ld+json" set:html={personJsonLd} />
     ```

4. Verify the build succeeds:
   - Run `npm run build` from the project root
   - Check that both locale pages in dist/ contain the new tags
  </action>
  <verify>
- `npm run build` completes without errors
- `grep 'hreflang' dist/index.html` shows it, en, x-default tags
- `grep 'hreflang' dist/en/index.html` shows it, en, x-default tags
- `grep 'og:image' dist/index.html` shows absolute URL to og-image.png
- `grep 'application/ld+json' dist/index.html` shows JSON-LD script
- `grep 'og:locale' dist/index.html` shows it_IT
- `grep 'og:locale' dist/en/index.html` shows en_US
- `grep 'twitter:card' dist/index.html` shows summary_large_image
  </verify>
  <done>Both locale pages contain hreflang tags (it, en, x-default) with absolute URLs, Person JSON-LD with localized jobTitle, og:image pointing to /og-image.png with dimensions, og:locale per language, and Twitter Card meta tags. Build passes cleanly.</done>
</task>

</tasks>

<verification>
1. `npm run build` -- clean build with no warnings
2. Check IT page (dist/index.html):
   - Contains 3 hreflang link tags with absolute URLs
   - Contains Person JSON-LD with Italian jobTitle array
   - Contains og:image with absolute URL to og-image.png
   - Contains og:locale content="it_IT"
   - Contains twitter:card content="summary_large_image"
3. Check EN page (dist/en/index.html):
   - Contains same 3 hreflang link tags
   - Contains Person JSON-LD with English jobTitle array
   - Contains og:locale content="en_US"
4. Verify og-image.png is 1200x630 PNG
5. Verify scroll-behavior: smooth in global.css with prefers-reduced-motion override
6. Manually test `/#imprenditoria` anchor link scrolls smoothly in dev server
</verification>

<success_criteria>
- Both locale pages have complete hreflang tags (it, en, x-default) with absolute URLs
- Person JSON-LD validates and has localized jobTitle per language
- og:image tag points to absolute URL of 1200x630 PNG
- og:locale shows it_IT on / and en_US on /en/
- Twitter Card tags present on both pages
- Smooth scrolling works on anchor links with prefers-reduced-motion fallback
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/05-seo-metadata/05-01-SUMMARY.md`
</output>
